(this.webpackJsonpk1weather=this.webpackJsonpk1weather||[]).push([[0],{17:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var n=r(18);r.d(t,"a",(function(){return n.b})),r.d(t,"c",(function(){return n.c}));var a={colorPrimary:"green",colorSecondary:"red",textPrimary:"#ccc",textSecondary:"#eee",background:"#eee"}},25:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return w}));var n=r(5),a=r.n(n),i=r(36),c=r(14),o=r(0),u=r.n(o),s=r(55),d=r(3),l=r(32),p=r(33),f=function(){function e(){Object(l.a)(this,e),this.WeatherstackAPIKey=void 0,this.WeatherstackAPIKey="8fe8b65c57ab73da437245762b0b941a"}return Object(p.a)(e,[{key:"fetchTopCities",value:function(){var e=Object(c.a)(a.a.mark((function e(){var t,r,n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://public.opendatasoft.com/api/records/1.0/search/?dataset=worldcitiespop&q=&rows=15&sort=population&facet=country",e.prev=1,e.next=4,fetch("https://public.opendatasoft.com/api/records/1.0/search/?dataset=worldcitiespop&q=&rows=15&sort=population&facet=country");case 4:return r=e.sent,e.next=7,r.json();case 7:return n=e.sent,i=null===n||void 0===n||null===(t=n.records)||void 0===t?void 0:t.map((function(e){var t,r,n,a;return{name:(null===e||void 0===e||null===(t=e.fields)||void 0===t?void 0:t.accentcity)||(null===e||void 0===e||null===(r=e.fields)||void 0===r?void 0:r.name),country:null===e||void 0===e||null===(n=e.fields)||void 0===n?void 0:n.country,region:null===e||void 0===e||null===(a=e.fields)||void 0===a?void 0:a.region}})).sort((function(e,t){return e.name.localeCompare(t.name)})),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchWeatherForCity",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var r,n,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="http://api.weatherstack.com/current?access_key=".concat(this.WeatherstackAPIKey,"&query=").concat(t),e.prev=1,e.next=4,fetch(r);case 4:return n=e.sent,e.next=7,n.json();case 7:return i=e.sent,c={city:{name:i.location.name,country:i.location.country,region:i.location.region},current:{observation_time:i.current.observation_time,temperature:i.current.temperature,weather_code:i.current.weather_code,weather_icons:i.current.weather_icons,weather_descriptions:i.current.weather_descriptions,wind_speed:i.current.wind_speed,wind_degree:i.current.wind_degree,wind_dir:i.current.wind_dir,pressure:i.current.pressure,precip:i.current.precip,humidity:i.current.humidity,cloudcover:i.current.cloudcover,feelslike:i.current.feelslike,uv_index:i.current.uv_index,visibility:i.current.visibility,is_day:"yes"===i.current.is_day,updated_at:new Date}},e.abrupt("return",c);case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchWeatherForLocation",value:function(){var e=Object(c.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://api.weatherstack.com/current?access_key=".concat(this.WeatherstackAPIKey,"&query=").concat(t,",").concat(r),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchWeatherForMyIP",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://api.weatherstack.com/current?access_key=".concat(this.WeatherstackAPIKey,"&query=fetch:ip"),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchLookup",value:function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://api.weatherstack.com/autocomplete?access_key=".concat(this.WeatherstackAPIKey,"&query=").concat(t),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),h=d.d.model("WeatherState",{observation_time:d.d.string,temperature:d.d.number,weather_code:d.d.number,weather_icons:d.d.array(d.d.string),weather_descriptions:d.d.array(d.d.string),wind_speed:d.d.number,wind_degree:d.d.number,wind_dir:d.d.string,pressure:d.d.number,precip:d.d.number,humidity:d.d.number,cloudcover:d.d.number,feelslike:d.d.number,uv_index:d.d.number,visibility:d.d.number,is_day:d.d.boolean,updated_at:d.d.Date}).actions((function(e){return{}})),m=d.d.model("CityState",{id:d.d.identifier,name:d.d.string,country:d.d.string,region:d.d.string,currentWeather:d.d.maybeNull(h)}).views((function(e){return{isUpdated:function(t){var r;return t.getTime()-((null===(r=e.currentWeather)||void 0===r?void 0:r.updated_at.getTime())||0)<6e5},isFavorite:function(){return-1!==Object(d.b)(e,v).favoriteCities.findIndex((function(t){return t===e}))}}})).actions((function(e){return{setCurrentWeather:function(t){e.name=t.city.name,e.country=t.city.country,e.region=t.city.region,e.currentWeather=h.create(t.current)}}})),v=d.d.model("AppState",{topCities:d.d.array(d.d.reference(m)),favoriteCities:d.d.array(d.d.reference(m)),cities:d.d.map(m)}).views((function(e){return{findCity:function(t){return e.cities.get(t)}}})).actions((function(e){return{addToTopCity:function(t){var r=e.topCities.findIndex((function(e){return e.name.localeCompare(t.name)>0}));-1===r?e.topCities.push(t):e.topCities.splice(r,0,t)},removeFromTopCity:function(t){var r=e.topCities.findIndex((function(e){return e===t}));-1!==r&&e.topCities.splice(r,1)}}})).actions((function(e){return{setTopCities:function(t){e.topCities.clear(),t.forEach((function(t){var r=e.cities.put(m.create({id:t.name,name:t.name,country:t.country,region:t.region}));r.isFavorite()||e.topCities.push(r)}))},addToFavorite:function(t){var r=e.favoriteCities.findIndex((function(e){return e.name.localeCompare(t.name)>0}));-1===r?e.favoriteCities.push(t):e.favoriteCities.splice(r,0,t),e.removeFromTopCity(t)},removeFromFavorite:function(t){var r=e.favoriteCities.findIndex((function(e){return e===t}));-1!==r&&(e.favoriteCities.splice(r,1),e.addToTopCity(t))},updateCurrentWeather:function(){return Object(c.a)(a.a.mark((function t(){var r,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(d.a)(e).api,n=new Date,t.next=4,Promise.all(Object(i.a)(e.cities.values()).map(function(){var e=Object(c.a)(a.a.mark((function e(t){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isUpdated(n)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.fetchWeatherForCity(t.name);case 4:(i=e.sent)&&t.setCurrentWeather(i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return t.stop()}}),t)})))()},addSearchedCityWeather:function(t){e.cities.put(m.create({id:t.city.name,name:t.city.name,country:t.city.country,region:t.city.region,currentWeather:h.create(t.current)}))}}})).actions((function(e){return{init:function(){return Object(c.a)(a.a.mark((function t(){var r,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(r=e.topCities)||void 0===r?void 0:r.length){t.next=5;break}return t.next=3,Object(d.a)(e).api.fetchTopCities();case 3:(n=t.sent)&&e.setTopCities(n);case 5:return t.next=7,e.updateCurrentWeather();case 7:case"end":return t.stop()}}),t)})))()},fetchCity:function(t){return Object(c.a)(a.a.mark((function r(){var n;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(d.a)(e).api.fetchWeatherForCity(t);case 2:(n=r.sent)&&e.addSearchedCityWeather(n);case 4:case"end":return r.stop()}}),r)})))()}}})),y=u.a.createContext(null),b=function(e){var t=e.children,r=Object(s.a)(k);return u.a.createElement(y.Provider,{value:r},t)},w=function(){var e=u.a.useContext(y);if(!e)throw new Error("useStore must be used within a StoreProvider.");return e};function k(){var e,t=localStorage.getItem("app-store"),r={api:new f};try{e=v.create(t?JSON.parse(t):{},r)}catch(n){console.error("could not restore, with the following error. fallback to empty store."),console.error(n),e=v.create({},r)}return Object(d.c)(e,(function(e){localStorage.setItem("app-store",JSON.stringify(e))})),e}},37:function(e,t,r){e.exports=r(51)},51:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(30),c=r.n(i),o=r(26),u=r(4),s=r(17),d=r(25),l=Object(n.lazy)((function(){return r.e(5).then(r.bind(null,63))})),p=Object(n.lazy)((function(){return r.e(3).then(r.bind(null,65))})),f=Object(n.lazy)((function(){return r.e(4).then(r.bind(null,64))})),h=Object(s.a)((function(e){return{"@global":{html:{backgroundColor:e.background},body:{margin:0},"html *":{fontFamily:"Yekan Bakh"}}}})),m=function(){var e=Object(s.c)();return h({theme:e}),a.a.createElement(d.a,null,a.a.createElement(o.a,null,a.a.createElement(u.c,null,a.a.createElement(u.a,{path:"/city/:name"},a.a.createElement(f,null)),a.a.createElement(u.a,{path:"/"},a.a.createElement(p,null)),a.a.createElement(u.a,{path:"*"},a.a.createElement(l,null)))))},v=function(){return a.a.createElement("div",null,"Loading...")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var y=r(18),b=r(24),w=r(54),k={en:{translation:{ttest:"TWeathr Test"}},de:{translation:{ttest:"Das wetter"}}};b.a.use(w.e).init({resources:k,lng:"en",interpolation:{escapeValue:!1}});b.a;c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(y.a,{theme:s.b},a.a.createElement(n.Suspense,{fallback:a.a.createElement(v,null)},a.a.createElement(m,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.6b059a78.chunk.js.map